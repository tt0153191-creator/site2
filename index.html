<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ë–∏—Ä–∂–∞ –¢—Ä—É–¥–∞</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg: #0f1012;
            --card: #1a1b1e;
            --text: #ffffff;
            --green: #4caf50;
            --yellow: #f1c40f;
            --gray: #888;
        }
        body { background: var(--bg); color: var(--text); font-family: -apple-system, sans-serif; margin: 0; padding: 15px; display: flex; flex-direction: column; align-items: center; }
        .header { width: 100%; max-width: 400px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .balance { background: #1c2e2a; color: #4db6ac; padding: 8px 15px; border-radius: 20px; font-weight: bold; border: 1px solid #264d47; cursor: pointer; }
        
        .payouts { width: 100%; max-width: 400px; background: var(--card); border-radius: 15px; padding: 10px; margin-bottom: 20px; border: 1px solid #2a2c31; }
        .payout-item { display: flex; justify-content: space-between; font-size: 12px; margin: 5px 0; border-bottom: 1px solid #222; padding-bottom: 5px; }
        .payout-item:last-child { border: none; }

        .task-card { background: var(--card); width: 100%; max-width: 370px; border-radius: 20px; padding: 15px; margin-bottom: 12px; display: flex; align-items: center; position: relative; }
        .task-img { width: 55px; height: 55px; border-radius: 12px; margin-right: 15px; object-fit: cover; }
        .task-info { flex-grow: 1; }
        .task-name { font-weight: bold; font-size: 13px; display: block; }
        .reward { position: absolute; top: 15px; right: 15px; color: var(--green); font-weight: bold; }
        .btn-act { position: absolute; bottom: 15px; right: 15px; background: var(--yellow); color: #000; border: none; padding: 7px 12px; border-radius: 10px; font-weight: bold; font-size: 11px; cursor: pointer; }

        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 1000; justify-content: center; align-items: center; }
        .modal-content { background: #25262b; padding: 20px; border-radius: 20px; width: 80%; max-width: 300px; text-align: center; }
        input { width: 100%; padding: 10px; margin: 10px 0; border-radius: 10px; border: 1px solid #444; background: #1a1b1e; color: #fff; box-sizing: border-box; }
        .btn-green { background: var(--green); color: #fff; border: none; padding: 12px; border-radius: 12px; width: 100%; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>

    <div class="header">
        <div><span style="color:var(--gray); font-size:12px;">–ë–∏—Ä–∂–∞ –¢—Ä—É–¥–∞</span><br><b id="u_name">–ü—Ä–∏–≤–µ—Ç, üëã</b></div>
        <div class="balance" onclick="openM('m_sum')">üí≥ <span id="u_bal">0</span> ‚ÇΩ</div>
    </div>

    <div style="font-size: 11px; color: var(--green); margin-bottom: 15px;">‚óè –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –æ–Ω–ª–∞–π–Ω–µ: 10 412</div>

    <div class="payouts">
        <div style="font-size: 12px; font-weight: bold; margin-bottom: 10px; display: flex; align-items: center;">üìâ –ü–æ—Å–ª–µ–¥–Ω–∏–µ –≤—ã–ø–ª–∞—Ç—ã</div>
        <div class="payout-item"><span>–ê*** –ú******</span> <span style="color:var(--green)">12 353 ‚ÇΩ</span></div>
        <div class="payout-item"><span>–¢****** –ü******</span> <span style="color:var(--green)">16 257 ‚ÇΩ</span></div>
        <div class="payout-item"><span>–ò*** –ê******</span> <span style="color:var(--green)">5 758 ‚ÇΩ</span></div>
    </div>

    <div class="task-card">
        <img src="https://images.unsplash.com/photo-1543269865-cbf427effbad?w=200" class="task-img">
        <div class="task-info">
            <span class="task-name">–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å 10 –¥—Ä—É–∑–µ–π</span>
            <div style="font-size:10px; color:var(--gray);">–í—ã–ø–æ–ª–Ω–µ–Ω–æ: 0 –∏–∑ 10</div>
        </div>
        <span class="reward">2 200 ‚ÇΩ</span>
        <button class="btn-act" onclick="openRef()">–í–´–ü–û–õ–ù–ò–¢–¨</button>
    </div>

    <div class="task-card">
        <img src="https://images.unsplash.com/photo-1517048676732-d65bc937f952?w=200" class="task-img">
        <div class="task-info">
            <span class="task-name">–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å 20 –¥—Ä—É–∑–µ–π</span>
            <div style="font-size:10px; color:var(--gray);">–í—ã–ø–æ–ª–Ω–µ–Ω–æ: 0 –∏–∑ 20</div>
        </div>
        <span class="reward">2 900 ‚ÇΩ</span>
        <button class="btn-act" onclick="openRef()">–í–´–ü–û–õ–ù–ò–¢–¨</button>
    </div>

    <div id="m_sum" class="modal">
        <div class="modal-content">
            <h3>–í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤</h3>
            <input type="number" id="i_sum" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É">
            <input type="tel" id="i_phone" placeholder="–ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã –∏–ª–∏ –°–ë–ü">
            <button class="btn-green" onclick="sendWithdraw()">–ó–∞–∫–∞–∑–∞—Ç—å –≤—ã–ø–ª–∞—Ç—É</button>
            <p onclick="closeM('m_sum')" style="color:var(--gray); cursor:pointer; font-size:12px; margin-top:15px;">–ó–∞–∫—Ä—ã—Ç—å</p>
        </div>
    </div>

    <div id="m_ref" class="modal">
        <div class="modal-content">
            <h3>–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞</h3>
            <p style="font-size: 11px; color: var(--gray);">–ü—Ä–∏–≥–ª–∞—à–∞–π –¥—Ä—É–∑–µ–π –∏ –ø–æ–ª—É—á–∞–π –±–æ–Ω—É—Å—ã!</p>
            <div id="ref_link" style="background:#111; padding:10px; font-size:10px; color:var(--yellow); margin:10px 0; border-radius:8px; word-break:break-all;"></div>
            <button class="btn-green" onclick="copyR()">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É</button>
            <p onclick="closeM('m_ref')" style="color:var(--gray); cursor:pointer; font-size:12px; margin-top:15px;">–ó–∞–∫—Ä—ã—Ç—å</p>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready(); tg.expand();

        const B_TOKEN = '7909769159:AAGPXQEYG2LCki54CSI09p2I2_E5w8Lh4D8';
        const ADMIN = '1827728855';
        const B_NAME = 'sfgdgdf_bot';

        let currentBal = 0; // –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –≤ 0 —Ä—É–±

        if(tg.initDataUnsafe.user) {
            document.getElementById('u_name').innerText = `–ü—Ä–∏–≤–µ—Ç, ${tg.initDataUnsafe.user.first_name} üëã`;
        }

        function openM(id) { document.getElementById(id).style.display = 'flex'; }
        function closeM(id) { document.getElementById(id).style.display = 'none'; }

        function openRef() {
            const uid = tg.initDataUnsafe.user ? tg.initDataUnsafe.user.id : "7861794182";
            document.getElementById('ref_link').innerText = `https://t.me/${B_NAME}?start=${uid}`;
            openM('m_ref');
        }

        function copyR() {
            navigator.clipboard.writeText(document.getElementById('ref_link').innerText);
            alert("–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!");
        }

        async function sendWithdraw() {
            const sum = document.getElementById('i_sum').value;
            const phone = document.getElementById('i_phone').value;

            if(sum < 100) return alert("–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –≤—ã–≤–æ–¥–∞ 100‚ÇΩ");
            if(sum > currentBal) return alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –Ω–∞ –±–∞–ª–∞–Ω—Å–µ!");
            if(!phone) return alert("–í–≤–µ–¥–∏—Ç–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã!");

            const text = `üí∞ –ó–ê–Ø–í–ö–ê –ù–ê –í–´–í–û–î\n–°—É–º–º–∞: ${sum}‚ÇΩ\n–†–µ–∫–≤–∏–∑–∏—Ç—ã: ${phone}`;
            
            try {
                const res = await fetch(`https://api.telegram.org/bot${B_TOKEN}/sendMessage`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({chat_id: ADMIN, text: text})
                });

                if(res.ok) {
                    currentBal -= sum;
                    document.getElementById('u_bal').innerText = currentBal;
                    alert("–ó–∞—è–≤–∫–∞ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!");
                    closeM('m_sum');
                }
            } catch(e) { alert("–û—à–∏–±–∫–∞ —Å–µ—Ç–∏"); }
        }
    </script>
</body>
</html>
